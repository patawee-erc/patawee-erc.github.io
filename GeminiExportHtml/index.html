<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to PPTX with Live Preview</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

    <style>
        body { background-color: #f8fafc; font-family: sans-serif; height: 100vh; overflow: hidden; }
        
        /* Container ‡∏´‡∏•‡∏±‡∏Å ‡πÅ‡∏ö‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏ß‡∏≤ */
        .main-layout {
            display: grid;
            grid-template-columns: 350px 1fr; /* ‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏°‡∏ô‡∏π ‡∏Ç‡∏ß‡∏≤‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß */
            height: 100vh;
        }

        /* ‡∏™‡πà‡∏ß‡∏ô Editor ‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ */
        .editor-panel {
            background: white;
            border-right: 1px solid #e2e8f0;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.05);
            z-index: 10;
        }

        /* ‡∏™‡πà‡∏ß‡∏ô Preview ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ */
        .preview-panel {
            background: #cbd5e1; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á workspace */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            overflow: hidden;
            position: relative;
        }

        /* ‡∏Å‡∏£‡∏≠‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (Wrapper) */
        #preview-wrapper {
            background: white;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            /* ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏î‡πâ‡∏ß‡∏¢ JS */
            width: 0; 
            height: 0;
            position: relative;
            transition: all 0.3s ease;
        }

        /* Iframe ‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á (‡∏Ç‡∏ô‡∏≤‡∏î Fixed 1920x1080 ‡πÄ‡∏™‡∏°‡∏≠) */
        #preview-frame {
            width: 1920px;
            height: 1080px;
            border: none;
            position: absolute;
            top: 0;
            left: 0;
            /* ‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏∏‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô */
            transform-origin: 0 0; 
            background-color: white;
        }
        
        .loading-overlay {
            position: absolute; inset: 0; background: rgba(255,255,255,0.8);
            display: flex; justify-content: center; align-items: center;
            z-index: 50; font-weight: bold; color: #3b82f6;
            backdrop-filter: blur(2px);
        }
    </style>
</head>
<body>

    <div class="main-layout">
        <!-- 1. Editor Panel (‡∏ã‡πâ‡∏≤‡∏¢) -->
        <div class="editor-panel">
            <h1 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                <span>‚ö° Code Editor</span>
            </h1>
            
            <div class="flex-1 flex flex-col mb-4">
                <label class="text-xs font-bold text-slate-500 mb-1">HTML CODE:</label>
                <textarea id="htmlInput" class="flex-1 w-full p-3 border border-slate-300 rounded bg-slate-50 font-mono text-xs focus:ring-2 focus:ring-blue-500 outline-none resize-none" placeholder="‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î HTML ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
            </div>

            <div class="flex flex-col gap-2">
                <button onclick="updatePreview()" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-2 px-4 rounded text-sm transition">
                    üîÑ Refresh Preview
                </button>
                
                   
                    <button onclick="exportFile('pptx')" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded text-sm transition">
                        Export PPTX
                    </button>
                
            </div>
            <p id="status" class="text-xs text-center text-slate-400 mt-2 h-4"></p>
        </div>

        <!-- 2. Preview Panel (‡∏Ç‡∏ß‡∏≤) -->
        <div class="preview-panel" id="previewPanel">
            <!-- Header ‡∏ö‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î -->
            <div class="absolute top-4 bg-white/80 px-3 py-1 rounded-full text-xs font-mono text-slate-600 shadow backdrop-blur">
                Canvas: 1920 x 1080 px
            </div>

            <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• -->
            <div id="preview-wrapper">
                <div id="loader" class="loading-overlay hidden">Updating...</div>
                <iframe id="preview-frame"></iframe>
            </div>
        </div>
    </div>

    <script>
        const htmlInput = document.getElementById('htmlInput');
        const previewFrame = document.getElementById('preview-frame');
        const previewWrapper = document.getElementById('preview-wrapper');
        const previewPanel = document.getElementById('previewPanel');
        const loader = document.getElementById('loader');
        const status = document.getElementById('status');
        
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Debounce (‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå)
        let typingTimer;

        // 1. Logic ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Scale ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡πà‡∏≠ 1920x1080 ‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á
        function resizePreview() {
            // ‡∏´‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ô Panel ‡∏Ç‡∏ß‡∏≤
            const availableWidth = previewPanel.clientWidth - 80; // ‡∏•‡∏ö padding
            const availableHeight = previewPanel.clientHeight - 80;

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° (‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠‡πÄ‡∏™‡∏°‡∏≠)
            const scaleX = availableWidth / 1920;
            const scaleY = availableHeight / 1080;
            const scale = Math.min(scaleX, scaleY); // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ

            // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î Wrapper ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö Iframe ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏¢‡πà‡∏≠
            previewWrapper.style.width = `${1920 * scale}px`;
            previewWrapper.style.height = `${1080 * scale}px`;

            // ‡∏™‡∏±‡πà‡∏á‡∏¢‡πà‡∏≠ Iframe
            previewFrame.style.transform = `scale(${scale})`;
        }

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        window.addEventListener('resize', resizePreview);

        // 2. Logic ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô HTML ‡∏•‡∏á Iframe
        function updatePreview() {
            loader.classList.remove('hidden'); // ‡πÇ‡∏ä‡∏ß‡πå loading
            const rawHtml = htmlInput.value;

            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° HTML structure ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Iframe
            let completeHtml = rawHtml;
            
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ Tailwind ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡πá‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ
            if (!completeHtml.includes('cdn.tailwindcss.com')) {
                completeHtml = `<script src="https://cdn.tailwindcss.com"><\/script>` + completeHtml;
            }

            // CSS Reset ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Iframe
            const resetStyle = `
                <style>
                    body { margin: 0; padding: 0; width: 1920px; height: 1080px; overflow: hidden; background-color: white; }
                    /* ‡∏ã‡πà‡∏≠‡∏ô Scrollbar */
                    ::-webkit-scrollbar { display: none; }
                </style>
            `;
            
            const iframeDoc = previewFrame.contentWindow.document;
            iframeDoc.open();
            iframeDoc.write(resetStyle + completeHtml);
            iframeDoc.close();

            // ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Iframe ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à (‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á Tailwind)
            previewFrame.onload = () => {
                setTimeout(() => {
                    loader.classList.add('hidden'); // ‡∏ã‡πà‡∏≠‡∏ô loading
                }, 500); // ‡∏£‡∏≠‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡πÉ‡∏´‡πâ CSS render ‡∏ä‡∏±‡∏ß‡∏£‡πå‡πÜ
            };
        }

        // 3. Auto Update ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå (Debounce 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
        htmlInput.addEventListener('keyup', () => {
            clearTimeout(typingTimer);
            status.innerText = "Typing...";
            typingTimer = setTimeout(() => {
                status.innerText = "Auto updating...";
                updatePreview();
                status.innerText = "";
            }, 1000);
        });

        // 4. Export Function (PDF / PPTX)
        async function exportFile(type) {
            status.innerText = "Processing...";
            loader.classList.remove('hidden');
            loader.innerText = "Exporting...";

            try {
                // ‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Iframe ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡πÇ‡∏ä‡∏ß‡πå‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏µ‡πà‡πÅ‡∏´‡∏•‡∏∞ (WYSIWYG)
                const iframeBody = previewFrame.contentWindow.document.body;

                // ‡∏£‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏ß‡∏£‡πå
                await document.fonts.ready;

                // HTML2Canvas
                const canvas = await html2canvas(iframeBody, {
                    width: 1920,
                    height: 1080,
                    scale: 1, // 1:1 ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Iframe 1920 ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
                    useCORS: true,
                    windowWidth: 1920,
                    windowHeight: 1080,
                    backgroundColor: "#ffffff"
                });

                if (type === 'pptx') {
                    const imgData = canvas.toDataURL('image/png');
                    let pptx = new PptxGenJS();
                    pptx.layout = 'LAYOUT_16x9';
                    let slide = pptx.addSlide();
                    slide.addImage({ data: imgData, x: 0, y: 0, w: '100%', h: '100%' });
                    await pptx.writeFile({ fileName: 'presentation.pptx' });
                } 
                else if (type === 'pdf') {
                    // ‡πÉ‡∏ä‡πâ jsPDF ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å canvas
                    // ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏õ‡∏Å ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ canvas ‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏õ‡∏∞‡∏•‡∏á PDF
                    const imgData = canvas.toDataURL('image/jpeg', 1.0);
                    const { jsPDF } = window.jspdf; // html2pdf bundle includes jspdf
                    // Create PDF 1920x1080 px
                    const pdf = new jsPDF({
                        orientation: 'landscape',
                        unit: 'px',
                        format: [1920, 1080]
                    });
                    pdf.addImage(imgData, 'JPEG', 0, 0, 1920, 1080);
                    pdf.save('presentation.pdf');
                }

                status.innerText = "Export Complete!";
            } catch (error) {
                console.error(error);
                alert("Error: " + error.message);
            } finally {
                loader.classList.add('hidden');
                loader.innerText = "Updating...";
                setTimeout(() => { status.innerText = ""; }, 3000);
            }
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
        resizePreview();
        // ‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
        htmlInput.value = `
<div class="w-full h-full bg-slate-900 flex items-center justify-center text-white relative overflow-hidden">
    <!-- Background Gradient -->
    <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-indigo-900 via-slate-900 to-black opacity-80"></div>
    
    <!-- Decorative Circle -->
    <div class="absolute top-10 right-10 w-64 h-64 bg-blue-500 rounded-full mix-blend-overlay filter blur-3xl opacity-30 animate-pulse"></div>

    <div class="relative z-10 text-center space-y-6 max-w-4xl">
        <span class="bg-blue-600 text-blue-100 text-sm font-bold px-3 py-1 rounded-full uppercase tracking-widest">
            Live Preview Mode
        </span>
        <h1 class="text-7xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-emerald-400">
            Gemini HTML code to PPTX
        </h1>
        <p class="text-2xl text-slate-300 font-light">
            ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ<br>
            ‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 1920 x 1080 Pixels
            <br>
            *** ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ ‡πÉ‡∏ä‡πâ gimini ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö ***
            <br>
            "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ html, ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© 1920 x 1080 ‡πÅ‡∏ö‡∏ö Fixed-width website, ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ font sarabun ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô"
        </p>
        
        <div class="grid grid-cols-3 gap-8 mt-12 text-left">
            <div class="bg-white/10 p-6 rounded-xl backdrop-blur-sm border border-white/10">
                <h3 class="text-xl font-bold text-blue-300 mb-2">üéØ 100% Accurate</h3>
                <p class="text-sm text-slate-400">‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á Preview ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Export 100%</p>
            </div>
            <div class="bg-white/10 p-6 rounded-xl backdrop-blur-sm border border-white/10">
                <h3 class="text-xl font-bold text-emerald-300 mb-2">üé® Tailwind Ready</h3>
                <p class="text-sm text-slate-400">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Tailwind CSS class ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏™‡∏µ‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô</p>
            </div>
            <div class="bg-white/10 p-6 rounded-xl backdrop-blur-sm border border-white/10">
                <h3 class="text-xl font-bold text-purple-300 mb-2">üìê 16:9 Fixed</h3>
                <p class="text-sm text-slate-400">‡∏•‡πá‡∏≠‡∏Ñ‡∏Ç‡∏ô‡∏≤‡∏î Full HD ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ Presentation</p>
            </div>
        </div>
    </div>
</div>`;
        // ‡∏£‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        updatePreview();

    </script>
</body>
</html>
